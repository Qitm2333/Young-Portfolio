# DAY13 - 2025.12.16 (周二)

## 今日完成

### 渲染问题修复

**阴影距离问题**：
- Game 视图无阴影但 Scene 有 → URP Asset 的 Shadow Max Distance 太小
- 调大后解决

**SSAO 环境光遮蔽**：
- 添加 Screen Space Ambient Occlusion Renderer Feature
- 摄像机距离远时 AO 不明显 → 调大 Radius 参数

---

### 自定义后处理：Screen Glow

创建柔和辉光效果，替代 URP 内置 Bloom：

**实现原理**：
- 原图模糊后用 Screen 混合模式叠加
- 比传统 Bloom 更柔和，适合风格化场景

**新增文件**：
- `Assets/Shader/PostProcess/ScreenGlow.shader` - 高斯模糊 + Screen 混合
- `Assets/Scripts/PostProcess/ScreenGlowVolume.cs` - Volume 参数
- `Assets/Scripts/PostProcess/ScreenGlowRenderFeature.cs` - URP 渲染特性

**参数**：
- Intensity：辉光强度（Screen 混合比例）
- Blur Size：模糊半径
- Iterations：模糊迭代次数
- Down Sample：降采样级别（性能优化）

---

### 藤蔓风吹动画 Shader

使用 ShaderGraph 实现面片藤蔓的风吹效果：

**核心节点连接**：
```
Time + 时间偏移属性
        ↓
    + UV.y × 3
        ↓
      Sine
        ↓
  × (1 - UV.y) × 强度  ← 顶部固定，底部摆动
        ↓
   Vector2(X, 0)
        ↓
    + 原始UV
        ↓
  Sample Texture
```

**优化**：
- 添加 Simple Noise 扰动，避免摆动过于规律
- 暴露"时间偏移"属性，不同藤蔓设不同值产生相位差

---

### 场景模型制作

完成大量场景装饰模型：
- 塔楼建筑
- 平台与桥梁
- 藤蔓面片（手绘贴图）
- 树木与植物
- 窗户装饰

**Blender 导出注意**：
- 多材质需要在 Edit Mode 下 Assign 面到材质槽
- 平滑法线：Object Mode → Shade Smooth 或导入时设 Normals=Calculate
- 没有 UV 的模型无法正确显示纹理

---

## 待完成清单（从 DAY12 继承）

### 建筑装饰
- [x] 塔楼模型与材质
- [ ] 拱门模型与材质 ← 明天完成

### 植物系统
- [x] 藤蔓面片 + 风吹动画
- [x] 树木模型
- [x] 花盆
- [ ] 花朵 ← 明天找资产
- [x] 水生植物（荷叶）

### 场景道具
- [x] 提灯
- [x] 座椅

### 水景系统
- [x] 池塘

### 氛围元素
- [ ] 鸟
- [ ] 大气效果

---

## Memory

- [x] SSAO 不明显 → 摄像机远时需要调大 Radius
- [x] 多材质模型只显示一个 → Blender 里要 Assign 面到材质槽
- [x] 藤蔓同步摆动 → 暴露时间偏移属性，每个实例设不同值
- [x] Unity 2021.3 API → 用 RenderTargetHandle + cmd.Blit，不用 RTHandle
- [x] FBX 没有碰撞 → 添加 Mesh Collider，复杂形状关闭 Convex
- [x] 透明材质无阴影 → 用 Alpha Clip 代替 Transparent
- [x] 远处阴影消失 → 调高 Shadow Resolution（Lighting 栏里）
- [x] 锐边导致光照伪影 → 用 Shade Flat 或去掉 Mark Sharp
- [x] URP 自发光 → 材质里勾选 Emission，设置 HDR 颜色

---

## 当前效果

场景已具备完整的视觉风格：
- 柔和的水彩/油画风格渲染
- 藤蔓随风摆动
- 层次丰富的建筑布局
- 梦幻的粉紫色调背景

---

## 下一步

- [ ] 拱门模型
- [ ] 花朵资产
- [ ] 角色与交互测试
- [ ] 场景整体打光调整
