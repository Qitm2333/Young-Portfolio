# DAY16 - 2025.12.19 (周六)

## 今日任务

### 角色系统
- [x] 角色建模（Blender）
- [x] 角色材质贴图
- [x] 腿部骨骼绑定与走路动画
- [x] Unity 导入与 Animator 设置
- [x] 围巾/披风飘动效果
- [x] 裙子微动效果

### 魔方线框优化
- [x] 手绘风格抖动线框
- [x] 线条粗细可调
- [x] 颜色状态切换（默认/激活/禁止）
- [x] 颜色平滑过渡
- [x] 透明度支持

### Bug 修复
- [x] PuzzleCube 玩家隐藏问题

---

## 完成内容

### 角色建模与绑定

采用极简分体式方案（参考纪念碑谷风格）：
- 身体+头+头发：静态模型，无骨骼
- 腿部：简单骨骼（Hips → Leg.L/R → Foot.L/R），Automatic Weights 蒙皮
- 围巾/裙子：独立模型，脚本控制动态

### Unity 动画系统

**Animator Controller 设置**：
- Generic 类型（非 Humanoid）
- Idle ↔ Walk 状态切换
- IsWalking 参数控制
- Loop Time 循环播放

**PlayerController 动画集成**：
- 添加 legAnimator 引用
- 根据 isMoving 状态切换动画

**坐标系问题修复**：
- Blender Z-up → Unity Y-up 导致旋转偏移
- 解决方案：套一层空物体调整朝向，避免动画覆盖

### 服装动态效果

**ScarfWave** `Assets/Scripts/Player/ScarfWave.cs`：
- 多层正弦波叠加，产生自然不规则摆动
- 基础波 + 噪波1 + 噪波2 + 慢速大波
- 移动时幅度增大
- 支持 X/Y/Z 轴选择

**SkirtSway** `Assets/Scripts/Player/SkirtSway.cs`：
- 轻微缩放呼吸（裙摆张开收拢）
- 上下浮动
- Y 轴微旋转
- 移动响应增益

### 魔方线框手绘风格

**SimpleCubeRotator 线框优化**：
- LineRenderer 分段抖动（jitterSegments）
- 多层噪波叠加，端点不抖动
- 线条粗细可调（lineWidth）
- 运行时参数修改自动重建
- 颜色平滑过渡（colorTransitionSpeed）
- URP 透明材质支持

### Bug 修复

**PuzzleCube 玩家隐藏**：
- 问题：只隐藏第一个子物体，多部件角色部分显示
- 修复：`SetPlayerVisibility()` 遍历所有子物体

---

## Memory

- [x] 极简角色方案 → 分体式（身体静态 + 腿部动画 + 服装脚本）
- [x] Blender 导出 FBX → Bake Animation 必须勾选
- [x] Generic Rig → 非标准人形骨骼使用
- [x] 动画覆盖旋转问题 → 套空物体隔离
- [x] 自然摆动 → 多层不同频率正弦波叠加
- [x] 服装微动 → 缩放呼吸 + 位移 + 旋转组合
- [x] 手绘线框 → LineRenderer 分段 + 噪波抖动
- [x] URP 透明材质 → 设置 _Surface=1, BlendMode, renderQueue
- [x] 颜色平滑过渡 → Color.Lerp + deltaTime * speed

---

## 下一步

- [ ] UI 系统
- [ ] 魔方纹路系统
- [ ] 第二场景制作
